<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NO MAN'S LAND ‚Äî Digital Store</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Share+Tech+Mono&family=Barlow:ital,wght@0,300;0,400;0,600;0,700&display=swap" rel="stylesheet">
<style>
/* ‚îÄ‚îÄ THEME VARIABLES ‚îÄ‚îÄ */
:root {
  --bg: #03050a;
  --surface: #070d16;
  --surface2: #0a1422;
  --border: #0e2030;
  --border2: #1a3a50;
  --accent: #e8c547;
  --accent-rgb: 232,197,71;
  --accent2: #ff4040;
  --accent3: #00b8d4;
  --text: #d0e4ef;
  --muted: #3a5a6e;
  --muted2: #5a7a8e;
  --glow: 0 0 24px rgba(var(--accent-rgb),0.35);
}

/* THEME DEFINITIONS */
body.theme-yellow { --accent:#e8c547; --accent-rgb:232,197,71; }
body.theme-red { --accent:#ff4040; --accent-rgb:255,64,64; --border:rgba(255,64,64,.12); --border2:rgba(255,64,64,.25); }
body.theme-blue { --accent:#00b8d4; --accent-rgb:0,184,212; --border:rgba(0,184,212,.12); --border2:rgba(0,184,212,.25); }
body.theme-green { --accent:#00e676; --accent-rgb:0,230,118; --border:rgba(0,230,118,.12); --border2:rgba(0,230,118,.25); }
body.theme-white { --accent:#ffffff; --accent-rgb:255,255,255; --border:rgba(255,255,255,.1); --border2:rgba(255,255,255,.2); --bg:#080808; }
body.theme-orange { --accent:#ff8c00; --accent-rgb:255,140,0; --border:rgba(255,140,0,.12); --border2:rgba(255,140,0,.25); }
body.theme-pink { --accent:#ff4db8; --accent-rgb:255,77,184; --border:rgba(255,77,184,.12); --border2:rgba(255,77,184,.25); }
body.theme-rainbow { --accent:url(#rainbow); }
body.theme-blackwhite { --accent:#ffffff; --accent-rgb:255,255,255; --bg:#000; --surface:#0a0a0a; --surface2:#111; --border:#222; --border2:#333; --text:#eee; --muted:#555; --muted2:#777; }
body.theme-black { --accent:#444; --accent-rgb:68,68,68; --bg:#000; --surface:#050505; --surface2:#0a0a0a; --border:#111; --border2:#1a1a1a; --text:#888; --muted:#333; --muted2:#444; }

/* RAINBOW special handling */
body.theme-rainbow { --accent:#ff4db8; --accent-rgb:255,77,184; }
body.theme-rainbow .logo,
body.theme-rainbow .hero-title .t2,
body.theme-rainbow .pc-price,
body.theme-rainbow .stat-n,
body.theme-rainbow .detail-price { background: linear-gradient(90deg,#ff0000,#ff8c00,#ffe000,#00e676,#00b8d4,#7c4dff,#ff4db8); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
body.theme-rainbow .ticker { background: linear-gradient(90deg,#ff0000,#ff8c00,#ffe000,#00e676,#00b8d4,#7c4dff,#ff4db8); }
body.theme-rainbow .btn-primary { background: linear-gradient(90deg,#ff8c00,#ff4db8); color:#fff; }
body.theme-rainbow nav { border-bottom-color: rgba(255,77,184,.2); }

*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:'Barlow',sans-serif;overflow-x:hidden;transition:background .4s,color .4s}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--accent)}
body::before{content:'';position:fixed;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.025'/%3E%3C/svg%3E");pointer-events:none;z-index:9998;opacity:.5}
body::after{content:'';position:fixed;inset:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,.06) 2px,rgba(0,0,0,.06) 4px);pointer-events:none;z-index:9997}

/* CURSOR */
.cur{position:fixed;pointer-events:none;z-index:9999;transform:translate(-50%,-50%)}
.cur-dot{width:8px;height:8px;background:var(--accent);border-radius:50%;box-shadow:var(--glow);transition:transform .15s}
.cur-ring{width:32px;height:32px;border:1px solid rgba(var(--accent-rgb),.35);border-radius:50%}

/* ANNOUNCEMENT BANNER */
#announceBanner{display:none;position:relative;z-index:200;padding:10px 48px;text-align:center;font-family:'Share Tech Mono',monospace;font-size:11px;letter-spacing:3px;text-transform:uppercase;font-weight:700}
#announceBanner.yellow{background:var(--accent);color:var(--bg)}
#announceBanner.red{background:#ff4040;color:#fff}
#announceBanner.blue{background:#00b8d4;color:var(--bg)}
.banner-close{position:absolute;right:20px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;font-size:16px;opacity:.6}
.banner-close:hover{opacity:1}

/* NAV */
nav{position:fixed;top:0;left:0;right:0;z-index:500;display:flex;align-items:center;justify-content:space-between;padding:0 48px;height:64px;background:linear-gradient(180deg,rgba(3,5,10,.98),rgba(3,5,10,.6));border-bottom:1px solid rgba(var(--accent-rgb),.08);backdrop-filter:blur(12px);transition:top .3s}
.logo{font-family:'Bebas Neue',sans-serif;font-size:24px;letter-spacing:8px;color:var(--accent);text-shadow:var(--glow);text-decoration:none;position:relative}
.nav-right{display:flex;align-items:center;gap:20px}
.nav-btn{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;text-transform:uppercase;color:var(--muted2);background:none;border:none;cursor:pointer;transition:color .2s;padding:4px 0;text-decoration:none;position:relative}
.nav-btn::after{content:'';position:absolute;bottom:-2px;left:0;right:100%;height:1px;background:var(--accent);transition:right .3s}
.nav-btn:hover{color:var(--accent)}.nav-btn:hover::after{right:0}
.nav-discord{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;color:var(--bg);background:var(--accent);border:none;padding:8px 18px;clip-path:polygon(8px 0%,100% 0%,calc(100% - 8px) 100%,0% 100%);cursor:pointer;text-transform:uppercase;text-decoration:none;display:inline-block;transition:all .2s;font-weight:700}
.nav-discord:hover{opacity:.85;box-shadow:var(--glow)}

/* USER AVATAR */
.nav-user{display:flex;align-items:center;gap:8px;cursor:pointer;position:relative}
.nav-avatar{width:32px;height:32px;border-radius:50%;border:2px solid var(--accent);box-shadow:var(--glow)}
.nav-username{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--accent);text-transform:uppercase}
.user-dropdown{position:absolute;top:calc(100% + 8px);right:0;background:var(--surface);border:1px solid rgba(var(--accent-rgb),.2);min-width:180px;z-index:600;display:none}
.nav-user:hover .user-dropdown{display:block}
.user-dropdown-item{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;padding:10px 14px;color:var(--muted2);cursor:pointer;transition:all .2s;border:none;background:none;width:100%;text-align:left}
.user-dropdown-item:hover{color:var(--accent);background:rgba(var(--accent-rgb),.05)}
.user-dropdown-item.danger{color:var(--accent2)}
.user-dropdown-item.danger:hover{background:rgba(255,64,64,.05)}

/* HERO */
.hero{min-height:100vh;display:flex;align-items:center;padding:80px 48px 60px;position:relative;overflow:hidden}
.hero-grid{position:absolute;inset:0;background-image:linear-gradient(rgba(var(--accent-rgb),.025) 1px,transparent 1px),linear-gradient(90deg,rgba(var(--accent-rgb),.025) 1px,transparent 1px);background-size:80px 80px;animation:gridDrift 25s linear infinite}
@keyframes gridDrift{to{transform:translateY(80px)}}
.hero-vignette{position:absolute;inset:0;background:radial-gradient(ellipse at 30% 50%,transparent 40%,rgba(3,5,10,.9) 100%)}
.hero-content{position:relative;z-index:2;max-width:640px}
.hero-eyebrow{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:5px;color:var(--accent);text-transform:uppercase;margin-bottom:28px;display:flex;align-items:center;gap:16px;animation:fadeUp .6s ease both}
.hero-eyebrow::before{content:'';width:32px;height:1px;background:var(--accent);box-shadow:var(--glow)}
.hero-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(80px,13vw,160px);line-height:.88;letter-spacing:3px;margin-bottom:32px;animation:fadeUp .6s .08s ease both}
.hero-title .t1{display:block;color:var(--text)}
.hero-title .t2{display:block;color:var(--accent);text-shadow:var(--glow)}
.hero-title .t3{display:block;color:var(--muted)}
.hero-desc{font-size:17px;font-weight:300;color:var(--muted2);max-width:440px;line-height:1.65;margin-bottom:48px;animation:fadeUp .6s .16s ease both}
.hero-desc strong{color:var(--text);font-weight:600}
.hero-actions{display:flex;gap:14px;animation:fadeUp .6s .24s ease both}
.btn{font-family:'Share Tech Mono',monospace;font-size:11px;letter-spacing:3px;text-transform:uppercase;text-decoration:none;display:inline-block;padding:14px 36px;cursor:pointer;border:none;transition:all .25s}
.btn-primary{color:var(--bg);background:var(--accent);clip-path:polygon(10px 0%,100% 0%,calc(100% - 10px) 100%,0% 100%);font-weight:700}
.btn-primary:hover{opacity:.85;box-shadow:var(--glow);transform:translateY(-2px)}
.btn-ghost{color:var(--accent);background:transparent;border:1px solid rgba(var(--accent-rgb),.25)}
.btn-ghost:hover{border-color:var(--accent);background:rgba(var(--accent-rgb),.05);box-shadow:var(--glow)}
.hero-badge{position:absolute;right:80px;top:50%;transform:translateY(-50%);z-index:2;display:flex;flex-direction:column;gap:28px;animation:fadeUp .8s .4s ease both}
.stat{text-align:right;border-right:2px solid var(--accent);padding-right:16px;position:relative}
.stat::before{content:'';position:absolute;right:-5px;top:50%;transform:translateY(-50%);width:8px;height:8px;background:var(--accent);border-radius:50%;box-shadow:var(--glow)}
.stat-n{font-family:'Bebas Neue',sans-serif;font-size:38px;color:var(--accent);line-height:1;text-shadow:var(--glow)}
.stat-l{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:3px;color:var(--muted);text-transform:uppercase}
@keyframes fadeUp{from{opacity:0;transform:translateY(24px)}to{opacity:1;transform:translateY(0)}}

/* TICKER */
.ticker{background:var(--accent);overflow:hidden;padding:8px 0}
.ticker-track{display:flex;animation:tickerScroll 28s linear infinite;white-space:nowrap}
.ticker-item{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:4px;color:var(--bg);text-transform:uppercase;padding:0 36px;font-weight:700}
@keyframes tickerScroll{to{transform:translateX(-50%)}}

/* SECTION */
.section{padding:90px 48px}
.sec-head{margin-bottom:40px}
.sec-label{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:5px;color:var(--accent);text-transform:uppercase;margin-bottom:10px;display:flex;align-items:center;gap:10px}
.sec-label::before{content:'//';color:var(--muted)}
.sec-title{font-family:'Bebas Neue',sans-serif;font-size:52px;letter-spacing:3px;line-height:1}

/* SEARCH */
.search-wrap{position:relative;max-width:320px}
.search-input{width:100%;background:var(--surface2);border:1px solid var(--border2);color:var(--text);font-family:'Share Tech Mono',monospace;font-size:11px;letter-spacing:2px;padding:10px 40px 10px 14px;outline:none;transition:border-color .2s}
.search-input:focus{border-color:var(--accent)}
.search-input::placeholder{color:var(--muted)}
.search-icon{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:var(--muted);font-size:14px;pointer-events:none}
.sec-head-row{display:flex;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;gap:16px;margin-bottom:24px}

/* FILTER */
.filter-bar{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:32px}
.filter-btn{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;padding:7px 16px;background:transparent;border:1px solid var(--border2);color:var(--muted2);cursor:pointer;transition:all .2s}
.filter-btn.active,.filter-btn:hover{border-color:var(--accent);color:var(--accent);background:rgba(var(--accent-rgb),.05)}

/* PRODUCTS */
#products-section{background:var(--surface);border-top:1px solid var(--border);border-bottom:1px solid var(--border)}
.products-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:2px}
.product-card{background:var(--bg);border:1px solid var(--border);overflow:hidden;position:relative;cursor:pointer;transition:border-color .3s,transform .3s}
.product-card:hover{border-color:rgba(var(--accent-rgb),.4);transform:translateY(-4px);z-index:2}
.product-card:hover .pc-overlay{opacity:1}
.product-card:hover .pc-buy{transform:translateY(0);opacity:1}
.product-card.coming-soon{opacity:.65;cursor:default}
.product-card.coming-soon:hover{transform:none;border-color:var(--border)}
.pc-img{height:220px;position:relative;overflow:hidden;background:var(--surface2);display:flex;align-items:center;justify-content:center}
.pc-img img{width:100%;height:100%;object-fit:cover}
.pc-img-placeholder{font-size:64px;opacity:.1;font-family:'Bebas Neue',sans-serif;color:var(--accent)}
.pc-overlay{position:absolute;inset:0;background:linear-gradient(135deg,rgba(var(--accent-rgb),.08),rgba(0,184,212,.05));opacity:0;transition:opacity .3s}
.pc-badge{position:absolute;top:14px;left:14px;font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:2px;padding:3px 10px;text-transform:uppercase;clip-path:polygon(5px 0%,100% 0%,calc(100% - 5px) 100%,0% 100%)}
.badge-new{background:#00b8d4;color:var(--bg)}.badge-hot{background:#ff4040;color:#fff}.badge-sale{background:var(--accent);color:var(--bg)}.badge-limited{background:#9b59b6;color:#fff}.badge-soon{background:var(--muted);color:var(--bg)}
.pc-views{position:absolute;top:14px;right:14px;font-family:'Share Tech Mono',monospace;font-size:8px;color:rgba(255,255,255,.4);background:rgba(0,0,0,.5);padding:2px 8px}
.pc-buy{position:absolute;bottom:0;left:0;right:0;background:rgba(var(--accent-rgb),.92);color:var(--bg);font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;text-align:center;padding:11px;text-transform:uppercase;font-weight:700;transform:translateY(100%);opacity:0;transition:transform .3s,opacity .3s}
.pc-body{padding:20px 22px 22px;border-top:1px solid var(--border)}
.pc-cat{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:3px;color:var(--accent);text-transform:uppercase;margin-bottom:6px}
.pc-name{font-size:17px;font-weight:700;color:var(--text);margin-bottom:8px;line-height:1.3}
.pc-desc{font-size:13px;font-weight:300;color:var(--muted2);margin-bottom:16px;line-height:1.5}
.pc-foot{display:flex;align-items:center;justify-content:space-between}
.pc-price{font-family:'Bebas Neue',sans-serif;font-size:30px;color:var(--accent);letter-spacing:2px;text-shadow:var(--glow)}
.pc-price .orig{font-size:16px;color:var(--muted);text-decoration:line-through;margin-right:6px}
.pc-stock{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:2px;color:var(--muted);text-transform:uppercase}
.pc-variants{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:12px}
.pc-variant-tag{font-family:'Share Tech Mono',monospace;font-size:8px;padding:2px 8px;border:1px solid var(--border2);color:var(--muted2)}
.empty-state{grid-column:1/-1;text-align:center;padding:80px 20px;font-family:'Share Tech Mono',monospace;font-size:12px;letter-spacing:3px;color:var(--muted);text-transform:uppercase}
.loading-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:2px}
.skeleton{background:var(--surface2);border:1px solid var(--border);overflow:hidden;position:relative}
.skeleton::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(var(--accent-rgb),.03),transparent);animation:shimmer 1.5s infinite}
@keyframes shimmer{from{transform:translateX(-100%)}to{transform:translateX(100%)}}
.skel-img{height:220px}.skel-body{padding:20px}
.skel-line{height:12px;background:var(--border2);border-radius:2px;margin-bottom:10px}.skel-line.short{width:60%}

/* TRUST */
.trust{background:var(--bg);border-top:1px solid var(--border);border-bottom:1px solid var(--border)}
.trust-grid{display:grid;grid-template-columns:repeat(4,1fr)}
.trust-item{padding:48px 36px;border-right:1px solid var(--border);position:relative;overflow:hidden;transition:background .3s}
.trust-item:last-child{border-right:none}
.trust-item:hover{background:rgba(var(--accent-rgb),.02)}
.trust-num{position:absolute;top:-10px;right:-5px;font-family:'Bebas Neue',sans-serif;font-size:100px;color:var(--accent);opacity:.025;line-height:1;pointer-events:none}
.trust-icon{font-size:26px;margin-bottom:16px;display:block}
.trust-title{font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:var(--text);margin-bottom:10px}
.trust-desc{font-size:13px;font-weight:300;color:var(--muted2);line-height:1.6}

/* CTA */
.cta-section{padding:100px 48px;text-align:center;position:relative;overflow:hidden}
.cta-bg{position:absolute;inset:0;background:radial-gradient(ellipse at 50% 50%,rgba(var(--accent-rgb),.04) 0%,transparent 60%)}
.cta-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(48px,8vw,96px);letter-spacing:4px;margin-bottom:20px;position:relative;z-index:2}
.cta-title span{color:var(--accent);text-shadow:var(--glow)}
.cta-sub{font-size:15px;color:var(--muted2);max-width:460px;margin:0 auto 40px;line-height:1.65;position:relative;z-index:2}
.cta-btns{display:flex;justify-content:center;gap:14px;position:relative;z-index:2}

/* FOOTER */
footer{border-top:1px solid var(--border);padding:36px 48px;display:flex;align-items:center;justify-content:space-between}
.foot-logo{font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:6px;color:var(--muted)}
.foot-copy{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted);text-transform:uppercase}
.foot-links{display:flex;gap:20px}
.foot-links a{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:2px;color:var(--muted);text-decoration:none;text-transform:uppercase;transition:color .2s;cursor:pointer}
.foot-links a:hover{color:var(--accent)}

/* MODALS */
.modal-overlay{position:fixed;inset:0;z-index:1000;background:rgba(3,5,10,.92);backdrop-filter:blur(8px);display:none;align-items:center;justify-content:center;padding:20px}
.modal-overlay.open{display:flex}
@keyframes modalIn{from{opacity:0;transform:scale(.95) translateY(20px)}to{opacity:1;transform:scale(1) translateY(0)}}
.modal-close{position:absolute;top:16px;right:20px;font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--muted);background:none;border:none;cursor:pointer;text-transform:uppercase;transition:color .2s}
.modal-close:hover{color:var(--accent2)}

/* PRODUCT DETAIL */
.detail-modal{background:var(--surface);border:1px solid rgba(var(--accent-rgb),.2);width:100%;max-width:780px;max-height:92vh;overflow-y:auto;position:relative;animation:modalIn .3s ease}
.detail-modal::-webkit-scrollbar{width:3px}.detail-modal::-webkit-scrollbar-thumb{background:var(--accent)}
.detail-layout{display:grid;grid-template-columns:1fr 1fr}
.detail-img{min-height:360px;background:var(--surface2);display:flex;align-items:center;justify-content:center;overflow:hidden}
.detail-img img{width:100%;height:100%;object-fit:cover}
.detail-img-placeholder{font-family:'Bebas Neue',sans-serif;font-size:80px;opacity:.1;color:var(--accent)}
.detail-body{padding:32px 28px;overflow-y:auto}
.detail-eyebrow{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:4px;color:var(--accent);text-transform:uppercase;margin-bottom:8px;display:flex;justify-content:space-between}
.detail-views{font-family:'Share Tech Mono',monospace;font-size:8px;color:var(--muted)}
.detail-name{font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--text);line-height:1;margin-bottom:14px}
.detail-price{font-family:'Bebas Neue',sans-serif;font-size:38px;color:var(--accent);letter-spacing:2px;text-shadow:var(--glow);line-height:1;margin-bottom:18px}
.detail-price .orig{font-size:20px;color:var(--muted);text-decoration:line-through;margin-right:8px}
.variants-label{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:3px;color:var(--muted2);text-transform:uppercase;margin-bottom:8px}
.variants-grid{display:flex;flex-direction:column;gap:5px;margin-bottom:18px}
.variant-row{display:flex;align-items:center;justify-content:space-between;background:var(--bg);border:1px solid var(--border);padding:9px 12px;cursor:pointer;transition:border-color .2s}
.variant-row:hover,.variant-row.selected{border-color:var(--accent);background:rgba(var(--accent-rgb),.04)}
.variant-name{font-size:13px;font-weight:600;color:var(--text)}
.variant-price{font-family:'Bebas Neue',sans-serif;font-size:18px;color:var(--accent)}
.variant-orig{font-size:12px;color:var(--muted);text-decoration:line-through;margin-right:5px}
.variant-stock{font-family:'Share Tech Mono',monospace;font-size:8px;color:var(--muted);margin-left:6px}
.coupon-row{display:flex;gap:6px;margin-bottom:8px}
.coupon-input{flex:1;background:var(--bg);border:1px solid var(--border2);color:var(--text);font-family:'Share Tech Mono',monospace;font-size:11px;padding:9px 12px;outline:none;text-transform:uppercase;letter-spacing:2px;transition:border-color .2s}
.coupon-input:focus{border-color:var(--accent)}
.coupon-input::placeholder{color:var(--muted);text-transform:none;letter-spacing:1px}
.coupon-btn{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;background:var(--surface2);border:1px solid var(--border2);color:var(--muted2);padding:9px 14px;cursor:pointer;transition:all .2s}
.coupon-btn:hover{border-color:var(--accent);color:var(--accent)}
.coupon-status{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;margin-bottom:10px;display:none}
.coupon-status.ok{color:#00c853}.coupon-status.err{color:var(--accent2)}
.final-price-row{display:none;align-items:center;justify-content:space-between;background:rgba(var(--accent-rgb),.05);border:1px solid rgba(var(--accent-rgb),.15);padding:10px 12px;margin-bottom:16px}
.final-price-label{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted2);text-transform:uppercase}
.final-price-val{font-family:'Bebas Neue',sans-serif;font-size:22px;color:var(--accent)}
.discord-input-group{margin-bottom:14px}
.discord-input-label{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:3px;color:var(--muted2);text-transform:uppercase;display:block;margin-bottom:5px}
.discord-input{width:100%;background:var(--bg);border:1px solid var(--border2);color:var(--text);font-family:'Share Tech Mono',monospace;font-size:12px;padding:9px 12px;outline:none;transition:border-color .2s}
.discord-input:focus{border-color:var(--accent)}
.btn-discord{display:flex;align-items:center;justify-content:center;gap:10px;background:#5865F2;color:#fff;font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;text-transform:uppercase;padding:13px;border:none;cursor:pointer;transition:all .2s;font-weight:700;width:100%;margin-bottom:6px}
.btn-discord:hover{background:#4752c4;box-shadow:0 0 20px rgba(88,101,242,.4)}
.btn-cancel{background:transparent;color:var(--muted);font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:3px;text-transform:uppercase;border:1px solid var(--border);padding:11px;cursor:pointer;transition:all .2s;width:100%}
.btn-cancel:hover{color:var(--accent2);border-color:rgba(255,64,64,.3)}
.detail-desc{font-size:12px;font-weight:300;color:var(--muted2);line-height:1.7;margin-top:16px;padding-top:16px;border-top:1px solid var(--border);white-space:pre-line}

/* THEME PICKER MODAL */
.theme-modal{background:var(--surface);border:1px solid rgba(var(--accent-rgb),.2);max-width:520px;width:100%;position:relative;animation:modalIn .3s ease}
.theme-head{padding:24px 28px 18px;border-bottom:1px solid var(--border)}
.theme-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:3px;color:var(--accent)}
.theme-sub{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted);margin-top:4px;text-transform:uppercase}
.theme-body{padding:20px 28px 28px}
.theme-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin-bottom:20px}
.theme-swatch{aspect-ratio:1;border-radius:4px;cursor:pointer;border:2px solid transparent;transition:all .2s;position:relative;display:flex;align-items:center;justify-content:center;font-size:10px;font-family:'Share Tech Mono',monospace}
.theme-swatch:hover{transform:scale(1.1)}
.theme-swatch.active{border-color:#fff;box-shadow:0 0 12px rgba(255,255,255,.3)}
.theme-swatch.locked{opacity:.4;cursor:not-allowed}
.theme-swatch.locked::after{content:'üîí';position:absolute;font-size:14px}
.theme-swatch:hover:not(.locked),.theme-swatch.active{transform:scale(1.1)}
.swatch-yellow{background:#e8c547}.swatch-red{background:#ff4040}.swatch-blue{background:#00b8d4}
.swatch-green{background:#00e676}.swatch-white{background:#fff}.swatch-orange{background:#ff8c00}
.swatch-pink{background:#ff4db8}.swatch-rainbow{background:linear-gradient(135deg,#ff0000,#ff8c00,#ffe000,#00e676,#00b8d4,#7c4dff,#ff4db8)}
.swatch-blackwhite{background:linear-gradient(135deg,#fff 50%,#000 50%)}.swatch-black{background:#111;border:1px solid #333}
.theme-custom{border-top:1px solid var(--border);padding-top:16px;margin-top:4px;display:none}
.theme-custom.show{display:block}
.custom-title{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:3px;color:var(--accent);text-transform:uppercase;margin-bottom:12px}
.custom-colors{display:flex;gap:12px;align-items:center;margin-bottom:12px}
.custom-color-wrap{display:flex;flex-direction:column;gap:4px;align-items:center}
.custom-color-label{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:2px;color:var(--muted);text-transform:uppercase}
.custom-color-input{width:56px;height:40px;border:1px solid var(--border2);cursor:pointer;padding:2px;background:var(--bg)}
.custom-gradient-preview{flex:1;height:40px;border-radius:2px;border:1px solid var(--border2)}
.btn-apply-custom{width:100%;background:var(--accent);color:var(--bg);font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;text-transform:uppercase;border:none;padding:11px;cursor:pointer;font-weight:700;transition:opacity .2s}
.btn-apply-custom:hover{opacity:.85}
.theme-member-note{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:1px;color:var(--muted);margin-top:12px;text-align:center}
.theme-member-note a{color:var(--accent);text-decoration:none}

/* WAITLIST */
.waitlist-modal{background:var(--surface);border:1px solid rgba(0,184,212,.25);max-width:440px;width:100%;clip-path:polygon(12px 0%,100% 0%,calc(100% - 12px) 100%,0% 100%);animation:modalIn .3s ease;position:relative}
.waitlist-head{padding:24px 28px 18px;border-bottom:1px solid var(--border)}
.waitlist-title{font-family:'Bebas Neue',sans-serif;font-size:26px;letter-spacing:3px;color:#00b8d4}
.waitlist-body{padding:20px 28px 26px}
.btn-waitlist{width:100%;background:#00b8d4;color:var(--bg);font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;text-transform:uppercase;border:none;padding:13px;cursor:pointer;font-weight:700;margin-top:14px;transition:opacity .2s}
.btn-waitlist:hover{opacity:.85}

/* LOGIN */
.login-modal{background:var(--surface);border:1px solid rgba(var(--accent-rgb),.2);max-width:400px;width:100%;clip-path:polygon(12px 0%,100% 0%,calc(100% - 12px) 100%,0% 100%);animation:modalIn .3s ease;position:relative}
.login-head{padding:28px 28px 20px;border-bottom:1px solid var(--border)}
.login-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:4px;color:var(--accent)}
.login-sub{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted);margin-top:5px;text-transform:uppercase}
.login-body{padding:24px 28px 28px}
.login-error{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--accent2);text-transform:uppercase;margin-bottom:12px;display:none}

/* ADMIN MODAL */
.admin-modal{background:var(--surface);border:1px solid rgba(var(--accent-rgb),.2);width:100%;max-width:800px;max-height:92vh;overflow-y:auto;position:relative;animation:modalIn .3s ease}
.admin-modal::-webkit-scrollbar{width:3px}.admin-modal::-webkit-scrollbar-thumb{background:var(--accent)}
.admin-head{padding:18px 28px 14px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;background:var(--surface);z-index:10}
.admin-title{font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:3px;color:var(--accent)}
.admin-tabs{display:flex;border-bottom:1px solid var(--border);overflow-x:auto}
.admin-tab{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:3px;color:var(--muted);text-transform:uppercase;padding:11px 18px;background:none;border:none;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;margin-bottom:-1px;white-space:nowrap}
.admin-tab.active,.admin-tab:hover{color:var(--accent);border-bottom-color:var(--accent)}
.tab-content{display:none}.tab-content.active{display:block}
.admin-section{padding:18px 28px;border-bottom:1px solid var(--border)}
.admin-section-title{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:4px;color:var(--muted);text-transform:uppercase;margin-bottom:14px}
.form-group{margin-bottom:12px}
.form-label{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted2);text-transform:uppercase;display:block;margin-bottom:5px}
.form-input{width:100%;background:var(--bg);border:1px solid var(--border2);color:var(--text);font-family:'Barlow',sans-serif;font-size:14px;padding:9px 12px;outline:none;transition:border-color .2s}
.form-input:focus{border-color:var(--accent)}
.form-input::placeholder{color:var(--muted)}
textarea.form-input{resize:vertical;min-height:70px}
select.form-input{cursor:pointer}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.form-row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
.img-upload-area{border:2px dashed var(--border2);padding:20px;text-align:center;cursor:pointer;transition:all .2s;position:relative}
.img-upload-area:hover{border-color:var(--accent)}
.img-upload-area input{position:absolute;inset:0;opacity:0;cursor:pointer}
.img-upload-icon{font-size:22px;margin-bottom:5px}
.img-upload-text{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted);text-transform:uppercase}
.img-preview{width:100%;max-height:110px;object-fit:cover;margin-top:8px;display:none}
.form-actions{padding:12px 28px 20px;display:flex;gap:8px}
.btn-save{flex:1;background:var(--accent);color:var(--bg);font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;text-transform:uppercase;border:none;padding:11px;cursor:pointer;font-weight:700;clip-path:polygon(8px 0%,100% 0%,calc(100% - 8px) 100%,0% 100%);transition:opacity .2s}
.btn-save:hover{opacity:.85}.btn-save:disabled{opacity:.5;cursor:not-allowed}
.btn-del{background:transparent;color:var(--accent2);border:1px solid rgba(255,64,64,.3);padding:11px 18px;font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;cursor:pointer;transition:all .2s}
.btn-del:hover{background:rgba(255,64,64,.1);border-color:var(--accent2)}
.prod-list{display:flex;flex-direction:column;gap:2px}
.prod-item{display:flex;align-items:center;gap:10px;background:var(--bg);border:1px solid var(--border);padding:9px 12px;cursor:pointer;transition:border-color .2s}
.prod-item:hover{border-color:rgba(var(--accent-rgb),.3)}
.prod-item-img{width:38px;height:38px;object-fit:cover;flex-shrink:0;background:var(--surface2)}
.prod-item-name{font-size:13px;font-weight:600;color:var(--text)}
.prod-item-cat{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:2px;color:var(--muted);text-transform:uppercase}
.prod-item-price{font-family:'Bebas Neue',sans-serif;font-size:16px;color:var(--accent);margin-left:auto;flex-shrink:0}
.variants-editor{margin-bottom:4px}
.variant-edit-row{display:grid;grid-template-columns:1fr 80px 80px 70px 28px;gap:5px;align-items:center;margin-bottom:5px}
.variant-edit-row input{background:var(--bg);border:1px solid var(--border2);color:var(--text);font-size:12px;padding:6px 8px;outline:none;transition:border-color .2s;width:100%}
.variant-edit-row input:focus{border-color:var(--accent)}
.btn-add-variant{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:2px;text-transform:uppercase;background:transparent;border:1px dashed var(--border2);color:var(--muted2);padding:7px;cursor:pointer;width:100%;transition:all .2s}
.btn-add-variant:hover{border-color:var(--accent);color:var(--accent)}
.btn-rm-variant{background:transparent;border:1px solid rgba(255,64,64,.2);color:var(--accent2);width:28px;height:28px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}
.btn-rm-variant:hover{background:rgba(255,64,64,.1)}

/* STATS CARDS */
.stats-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:20px}
.stat-card{background:var(--bg);border:1px solid var(--border);padding:18px 20px}
.stat-card-n{font-family:'Bebas Neue',sans-serif;font-size:36px;color:var(--accent);line-height:1;text-shadow:var(--glow)}
.stat-card-l{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:3px;color:var(--muted);text-transform:uppercase;margin-top:4px}

/* TABLES */
.inq-table,.coupon-table,.waitlist-table{width:100%;border-collapse:collapse}
.inq-table th,.coupon-table th,.waitlist-table th{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:3px;color:var(--muted);text-transform:uppercase;padding:7px 9px;border-bottom:1px solid var(--border);text-align:left}
.inq-table td,.coupon-table td,.waitlist-table td{font-size:12px;color:var(--text);padding:7px 9px;border-bottom:1px solid var(--border);vertical-align:top}
.inq-table tr:hover td{background:rgba(var(--accent-rgb),.02)}
.inq-price,.inq-product{font-weight:600}
.inq-price{font-family:'Bebas Neue',sans-serif;font-size:15px;color:var(--accent)}
.inq-user{font-family:'Share Tech Mono',monospace;font-size:10px;color:#00b8d4}
.inq-date{font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--muted)}
.status-badge{font-family:'Share Tech Mono',monospace;font-size:8px;letter-spacing:2px;padding:2px 7px;text-transform:uppercase;cursor:pointer;border:none;transition:all .2s}
.status-pending{background:rgba(var(--accent-rgb),.15);color:var(--accent);border:1px solid rgba(var(--accent-rgb),.3)}
.status-done{background:rgba(0,184,212,.1);color:#00b8d4;border:1px solid rgba(0,184,212,.3)}
.status-cancelled{background:rgba(255,64,64,.1);color:#ff4040;border:1px solid rgba(255,64,64,.3)}
.inq-empty{padding:24px;text-align:center;font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;color:var(--muted);text-transform:uppercase}
.coupon-code{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--accent);letter-spacing:2px}
.btn-coupon-del{background:none;border:none;color:var(--muted);cursor:pointer;font-size:14px;transition:color .2s}
.btn-coupon-del:hover{color:var(--accent2)}

/* TOAST */
.toast{position:fixed;bottom:32px;right:32px;z-index:9000;font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:2px;text-transform:uppercase;padding:13px 22px;border-left:3px solid var(--accent);background:var(--surface);color:var(--text);transform:translateX(120%);transition:transform .3s ease;max-width:300px}
.toast.show{transform:translateX(0)}.toast.error{border-color:var(--accent2)}

/* REVEAL */
.reveal{opacity:0;transform:translateY(24px);transition:opacity .6s,transform .6s}
.reveal.vis{opacity:1;transform:translateY(0)}

@media(max-width:768px){
  nav{padding:0 16px}.hero{padding:80px 20px 60px}.hero-badge{display:none}
  .section{padding:60px 20px}.trust-grid{grid-template-columns:1fr 1fr}
  .trust-item{border-bottom:1px solid var(--border)}
  footer{flex-direction:column;gap:16px;text-align:center;padding:24px 20px}
  .detail-layout{grid-template-columns:1fr}.detail-img{min-height:200px;max-height:240px}
  .admin-modal,.detail-modal{max-width:100%}
  .form-row,.form-row-3{grid-template-columns:1fr}
  .variant-edit-row{grid-template-columns:1fr 70px 60px 28px}
  .stats-grid{grid-template-columns:1fr 1fr}
}
</style>
</head>
<body class="theme-yellow">

<div class="cur" id="curDot"><div class="cur-dot"></div></div>
<div class="cur" id="curRing"><div class="cur-ring"></div></div>
<div class="toast" id="toast"></div>

<div id="announceBanner"><span id="announceText"></span><button class="banner-close" onclick="dismissBanner()">‚úï</button></div>

<nav id="mainNav">
  <a href="#" class="logo">NO MAN'S LAND</a>
  <div class="nav-right">
    <button class="nav-btn" onclick="smoothTo('#products-section')">Shop</button>
    <div id="navUserArea"></div>
    <button class="nav-btn" onclick="openLogin()">Admin</button>
    <a href="https://discord.gg/yRDud7tW" target="_blank" class="nav-discord">Discord</a>
  </div>
</nav>

<section class="hero">
  <div class="hero-grid"></div>
  <div class="hero-vignette"></div>
  <div class="hero-content">
    <div class="hero-eyebrow">Digital Goods ‚Äî All Categories</div>
    <h1 class="hero-title">
      <span class="t1">NO</span>
      <span class="t2">MAN'S</span>
      <span class="t3">LAND</span>
    </h1>
    <p class="hero-desc">Your one-stop shop for <strong>premium digital products</strong>. Instant delivery, trusted source, real prices.</p>
    <div class="hero-actions">
      <a href="#products-section" class="btn btn-primary">Browse Store</a>
      <a href="https://discord.gg/yRDud7tW" target="_blank" class="btn btn-ghost">Join Discord</a>
    </div>
  </div>
  <div class="hero-badge">
    <div class="stat"><div class="stat-n" id="statProducts">‚Äî</div><div class="stat-l">Products</div></div>
    <div class="stat"><div class="stat-n">24/7</div><div class="stat-l">Support</div></div>
    <div class="stat"><div class="stat-n">100%</div><div class="stat-l">Legit</div></div>
  </div>
</section>

<div class="ticker"><div class="ticker-track" id="tickerTrack"></div></div>

<section class="section" id="products-section">
  <div class="sec-head">
    <div class="sec-head-row reveal">
      <div><div class="sec-label">Inventory</div><h2 class="sec-title">THE STORE</h2></div>
      <div class="search-wrap">
        <input type="text" class="search-input" id="searchInput" placeholder="Search products..." oninput="handleSearch(this.value)">
        <span class="search-icon">üîç</span>
      </div>
    </div>
  </div>
  <div class="filter-bar" id="filterBar"></div>
  <div id="loadingGrid" class="loading-grid">
    <div class="skeleton"><div class="skel-img"></div><div class="skel-body"><div class="skel-line"></div><div class="skel-line short"></div><div class="skel-line" style="width:40%"></div></div></div>
    <div class="skeleton"><div class="skel-img"></div><div class="skel-body"><div class="skel-line"></div><div class="skel-line short"></div><div class="skel-line" style="width:40%"></div></div></div>
    <div class="skeleton"><div class="skel-img"></div><div class="skel-body"><div class="skel-line"></div><div class="skel-line short"></div><div class="skel-line" style="width:40%"></div></div></div>
    <div class="skeleton"><div class="skel-img"></div><div class="skel-body"><div class="skel-line"></div><div class="skel-line short"></div><div class="skel-line" style="width:40%"></div></div></div>
    <div class="skeleton"><div class="skel-img"></div><div class="skel-body"><div class="skel-line"></div><div class="skel-line short"></div><div class="skel-line" style="width:40%"></div></div></div>
    <div class="skeleton"><div class="skel-img"></div><div class="skel-body"><div class="skel-line"></div><div class="skel-line short"></div><div class="skel-line" style="width:40%"></div></div></div>
  </div>
  <div class="products-grid" id="productsGrid" style="display:none"></div>
</section>

<div class="trust reveal">
  <div class="trust-grid">
    <div class="trust-item"><div class="trust-num">01</div><span class="trust-icon">‚ö°</span><div class="trust-title">Instant Delivery</div><div class="trust-desc">Your digital goods handed off fast.</div></div>
    <div class="trust-item"><div class="trust-num">02</div><span class="trust-icon">üõ°Ô∏è</span><div class="trust-title">Buyer Protection</div><div class="trust-desc">Issues? Hit us up on Discord.</div></div>
    <div class="trust-item"><div class="trust-num">03</div><span class="trust-icon">üí¨</span><div class="trust-title">Direct Contact</div><div class="trust-desc">Real human behind every sale.</div></div>
    <div class="trust-item"><div class="trust-num">04</div><span class="trust-icon">üî•</span><div class="trust-title">Always Stocked</div><div class="trust-desc">Fresh products added regularly.</div></div>
  </div>
</div>

<section class="cta-section reveal">
  <div class="cta-bg"></div>
  <h2 class="cta-title">READY TO <span>BUY?</span></h2>
  <p class="cta-sub">Hit the button, DM us on Discord, and we'll sort you out.</p>
  <div class="cta-btns">
    <a href="#products-section" class="btn btn-primary">Browse Products</a>
    <a href="https://discord.gg/yRDud7tW" target="_blank" class="btn btn-ghost">Open Discord</a>
  </div>
</section>

<footer>
  <div class="foot-logo">NO MAN'S LAND</div>
  <div class="foot-copy">¬© 2025 No Man's Land</div>
  <div class="foot-links">
    <a onclick="smoothTo('#products-section')">Shop</a>
    <a href="https://discord.gg/yRDud7tW" target="_blank">Discord</a>
    <a onclick="openLogin()">Admin</a>
  </div>
</footer>

<!-- PRODUCT DETAIL MODAL -->
<div class="modal-overlay" id="detailOverlay">
  <div class="detail-modal">
    <button class="modal-close" onclick="closeModal('detailOverlay')">‚úï Close</button>
    <div class="detail-layout">
      <div class="detail-img" id="detailImg"></div>
      <div class="detail-body">
        <div class="detail-eyebrow"><span id="detailCat"></span><span class="detail-views" id="detailViews"></span></div>
        <div class="detail-name" id="detailName"></div>
        <div class="detail-price" id="detailPrice"></div>
        <div id="variantsSection" style="display:none">
          <div class="variants-label">Choose a variant:</div>
          <div class="variants-grid" id="variantsGrid"></div>
        </div>
        <div class="coupon-row">
          <input type="text" class="coupon-input" id="couponInput" placeholder="Coupon code (optional)" oninput="this.value=this.value.toUpperCase()">
          <button class="coupon-btn" onclick="applyCoupon()">Apply</button>
        </div>
        <div class="coupon-status" id="couponStatus"></div>
        <div class="final-price-row" id="finalPriceRow">
          <span class="final-price-label">Final Price</span>
          <span class="final-price-val" id="finalPriceVal"></span>
        </div>
        <div class="discord-input-group" id="discordInputGroup">
          <label class="discord-input-label">Your Discord Username</label>
          <input type="text" class="discord-input" id="detailDiscordUser" placeholder="@yourname (auto-filled if logged in)">
        </div>
        <button class="btn-discord" onclick="submitDetailInquiry()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M20.317 4.37a19.791 19.791 0 00-4.885-1.515.074.074 0 00-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 00-5.487 0 12.64 12.64 0 00-.617-1.25.077.077 0 00-.079-.037A19.736 19.736 0 003.677 4.37a.07.07 0 00-.032.027C.533 9.046-.32 13.58.099 18.057c.002.022.015.043.03.056a19.9 19.9 0 005.993 3.03.078.078 0 00.084-.028c.462-.63.874-1.295 1.226-1.995a.076.076 0 00-.041-.106 13.107 13.107 0 01-1.872-.892.077.077 0 01-.008-.128 10.2 10.2 0 00.372-.292.074.074 0 01.077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 01.078.01c.12.098.246.198.373.292a.077.077 0 01-.006.127 12.299 12.299 0 01-1.873.892.077.077 0 00-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 00.084.028 19.839 19.839 0 006.002-3.03.077.077 0 00.032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 00-.031-.03z"/></svg>
          Buy on Discord
        </button>
        <button class="btn-cancel" onclick="closeModal('detailOverlay')">Cancel</button>
        <div class="detail-desc" id="detailDesc"></div>
      </div>
    </div>
  </div>
</div>

<!-- THEME PICKER MODAL -->
<div class="modal-overlay" id="themeOverlay">
  <div class="theme-modal">
    <button class="modal-close" onclick="closeModal('themeOverlay')">‚úï</button>
    <div class="theme-head">
      <div class="theme-title">STORE THEME</div>
      <div class="theme-sub" id="themeSubtitle">Pick your vibe</div>
    </div>
    <div class="theme-body">
      <div class="theme-grid" id="themeGrid"></div>
      <div class="theme-custom" id="customThemeSection">
        <div class="custom-title">‚ú® Custom Gradient (Members Only)</div>
        <div class="custom-colors">
          <div class="custom-color-wrap"><span class="custom-color-label">Color 1</span><input type="color" class="custom-color-input" id="customColor1" value="#e8c547" oninput="updateGradientPreview()"></div>
          <div class="custom-gradient-preview" id="gradientPreview"></div>
          <div class="custom-color-wrap"><span class="custom-color-label">Color 2</span><input type="color" class="custom-color-input" id="customColor2" value="#ff4db8" oninput="updateGradientPreview()"></div>
        </div>
        <button class="btn-apply-custom" onclick="applyCustomTheme()">Apply Custom Gradient</button>
      </div>
      <div class="theme-member-note" id="themeMemberNote" style="display:none">
        üîí <a href="/auth/discord">Login with Discord</a> to unlock purchased themes. Members get custom gradients!
      </div>
    </div>
  </div>
</div>

<!-- WAITLIST MODAL -->
<div class="modal-overlay" id="waitlistOverlay">
  <div class="waitlist-modal">
    <button class="modal-close" onclick="closeModal('waitlistOverlay')">‚úï</button>
    <div class="waitlist-head"><div class="waitlist-title">JOIN WAITLIST</div><div style="font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted);margin-top:4px;text-transform:uppercase">Get notified when this launches</div></div>
    <div class="waitlist-body">
      <div style="font-size:14px;font-weight:600;color:var(--text);margin-bottom:14px" id="waitlistProductName"></div>
      <div class="form-group"><label class="form-label">Your Discord Username *</label><input type="text" class="form-input" id="waitlistDiscord" placeholder="@yourname"></div>
      <button class="btn-waitlist" onclick="submitWaitlist()">Notify Me When Live</button>
    </div>
  </div>
</div>

<!-- LOGIN MODAL -->
<div class="modal-overlay" id="loginOverlay">
  <div class="login-modal">
    <button class="modal-close" onclick="closeModal('loginOverlay')">‚úï</button>
    <div class="login-head"><div class="login-title">ADMIN ACCESS</div><div class="login-sub">No Man's Land Control Panel</div></div>
    <div class="login-body">
      <div class="login-error" id="loginError">Wrong password.</div>
      <div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" id="loginPassword" placeholder="Enter admin password" onkeydown="if(event.key==='Enter')doLogin()"></div>
      <div style="margin-top:14px"><button class="btn-save" style="width:100%;clip-path:none" onclick="doLogin()" id="loginBtn">Enter</button></div>
    </div>
  </div>
</div>

<!-- ADMIN MODAL -->
<div class="modal-overlay" id="adminOverlay">
  <div class="admin-modal">
    <div class="admin-head">
      <div class="admin-title">ADMIN PANEL</div>
      <div style="display:flex;gap:12px;align-items:center">
        <button class="nav-btn" onclick="adminLogout()" style="color:var(--accent2)">Logout</button>
        <button class="modal-close" style="position:static" onclick="closeModal('adminOverlay')">‚úï</button>
      </div>
    </div>
    <div class="admin-tabs">
      <button class="admin-tab active" onclick="switchTab('products')">Products</button>
      <button class="admin-tab" onclick="switchTab('orders')">Orders</button>
      <button class="admin-tab" onclick="switchTab('coupons')">Coupons</button>
      <button class="admin-tab" onclick="switchTab('waitlist')">Waitlist</button>
      <button class="admin-tab" onclick="switchTab('stats')">Stats</button>
      <button class="admin-tab" onclick="switchTab('announce')">Banner</button>
    </div>

    <!-- PRODUCTS -->
    <div class="tab-content active" id="tab-products">
      <div class="admin-section">
        <div class="admin-section-title" id="formTitle">Create New Product</div>
        <input type="hidden" id="editId">
        <div class="form-row">
          <div class="form-group"><label class="form-label">Name *</label><input type="text" class="form-input" id="fName" placeholder="Netflix Premium"></div>
          <div class="form-group"><label class="form-label">Category</label><select class="form-input" id="fCategory"><option>Accounts</option><option>Digital</option><option>Software</option><option>Gaming</option><option>Other</option></select></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label class="form-label">Price *</label><input type="number" class="form-input" id="fPrice" placeholder="9.99" step="0.01" min="0"></div>
          <div class="form-group"><label class="form-label">Original Price (crossed out)</label><input type="number" class="form-input" id="fOriginalPrice" placeholder="14.99" step="0.01" min="0"></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label class="form-label">Badge</label><select class="form-input" id="fBadge"><option value="">None</option><option value="NEW">NEW</option><option value="HOT">HOT</option><option value="SALE">SALE</option><option value="LIMITED">LIMITED</option><option value="SOON">SOON</option></select></div>
          <div class="form-group"><label class="form-label">Stock</label><input type="number" class="form-input" id="fStock" placeholder="999" min="0"></div>
        </div>
        <div class="form-group"><label class="form-label">Description</label><textarea class="form-input" id="fDesc" placeholder="Describe the product..."></textarea></div>
        <div class="form-row">
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:8px 0"><input type="checkbox" id="fFeatured"> <span class="form-label" style="margin:0">Featured</span></label>
          <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:8px 0"><input type="checkbox" id="fComingSoon"> <span class="form-label" style="margin:0">Coming Soon</span></label>
        </div>
        <div class="form-group">
          <label class="form-label">Variants</label>
          <div style="font-family:'Share Tech Mono',monospace;font-size:8px;color:var(--muted);letter-spacing:1px;margin-bottom:6px">Name | Sale Price | Original Price | Stock</div>
          <div class="variants-editor" id="variantsEditor"></div>
          <button class="btn-add-variant" onclick="addVariantRow()">+ Add Variant</button>
        </div>
        <div class="form-group"><label class="form-label">Image</label>
          <div class="img-upload-area"><input type="file" accept="image/*" id="fImage" onchange="previewImage(event)"><div class="img-upload-icon">üì∑</div><div class="img-upload-text">Click to upload</div><img class="img-preview" id="imgPreview"></div>
        </div>
      </div>
      <div class="form-actions">
        <button class="btn-save" id="saveBtn" onclick="saveProduct()">Save Product</button>
        <button class="btn-del" id="deleteBtn" style="display:none" onclick="deleteProduct()">Delete</button>
        <button class="btn-cancel" onclick="resetForm()">Clear</button>
      </div>
      <div class="admin-section"><div class="admin-section-title">Existing Products</div><div class="prod-list" id="adminProdList"></div></div>
    </div>

    <!-- ORDERS -->
    <div class="tab-content" id="tab-orders">
      <div class="admin-section">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <div class="admin-section-title" style="margin:0">Purchase Inquiries</div>
          <button class="nav-btn" onclick="loadInquiries()" style="font-size:9px">‚Üª Refresh</button>
        </div>
        <div id="inquiryContainer"><div class="inq-empty">Loading...</div></div>
      </div>
    </div>

    <!-- COUPONS -->
    <div class="tab-content" id="tab-coupons">
      <div class="admin-section">
        <div class="admin-section-title">Create Coupon</div>
        <div class="form-row-3">
          <div class="form-group"><label class="form-label">Code</label><input type="text" class="form-input" id="cCode" placeholder="SAVE20" oninput="this.value=this.value.toUpperCase()"></div>
          <div class="form-group"><label class="form-label">Discount %</label><input type="number" class="form-input" id="cPercent" placeholder="20" min="1" max="100"></div>
          <div class="form-group"><label class="form-label">Max Uses (0=‚àû)</label><input type="number" class="form-input" id="cMaxUses" placeholder="0" min="0"></div>
        </div>
        <div class="form-group"><label class="form-label">Expiry Date (optional)</label><input type="date" class="form-input" id="cExpiry"></div>
        <button class="btn-save" style="clip-path:none;margin-top:4px" onclick="createCoupon()">Create Coupon</button>
      </div>
      <div class="admin-section"><div class="admin-section-title">Active Coupons</div><div id="couponList"><div class="inq-empty">Loading...</div></div></div>
    </div>

    <!-- WAITLIST -->
    <div class="tab-content" id="tab-waitlist">
      <div class="admin-section">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <div class="admin-section-title" style="margin:0">Waitlist Signups</div>
          <button class="nav-btn" onclick="loadWaitlist()" style="font-size:9px">‚Üª Refresh</button>
        </div>
        <div id="waitlistContainer"><div class="inq-empty">Loading...</div></div>
      </div>
    </div>

    <!-- STATS -->
    <div class="tab-content" id="tab-stats">
      <div class="admin-section">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
          <div class="admin-section-title" style="margin:0">Store Statistics</div>
          <button class="nav-btn" onclick="loadStats()" style="font-size:9px">‚Üª Refresh</button>
        </div>
        <div class="stats-grid" id="statsGrid"><div class="inq-empty" style="grid-column:1/-1">Loading...</div></div>
      </div>
    </div>

    <!-- ANNOUNCE -->
    <div class="tab-content" id="tab-announce">
      <div class="admin-section">
        <div class="admin-section-title">Store Announcement Banner</div>
        <div class="form-group"><label class="form-label">Message</label><input type="text" class="form-input" id="aMessage" placeholder="üî• Flash sale ‚Äî today only!"></div>
        <div class="form-group"><label class="form-label">Color</label><select class="form-input" id="aColor"><option value="yellow">Yellow</option><option value="red">Red (urgent)</option><option value="blue">Blue (info)</option></select></div>
        <div style="display:flex;gap:10px;margin-top:8px">
          <button class="btn-save" style="clip-path:none" onclick="postAnnouncement()">Post Banner</button>
          <button class="btn-del" onclick="clearAnnouncement()">Clear Banner</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
const API = window.location.origin + '/api';
let adminToken = sessionStorage.getItem('nml_admin') || null;
let userToken = localStorage.getItem('nml_user') || null;
let currentUser = null;
let allProducts = [];
let currentProduct = null;
let selectedVariant = null;
let appliedCoupon = null;
let variantRows = [];
let searchTimer = null;
let waitlistProduct = null;

const THEMES = ['yellow','red','blue','green','white','orange','pink','rainbow','blackwhite','black'];
const THEME_NAMES = {yellow:'Yellow',red:'Red',blue:'Blue',green:'Green',white:'White',orange:'Orange',pink:'Pink',rainbow:'Rainbow',blackwhite:'B&W',black:'Black'};

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
window.addEventListener('load', () => {
  // Handle OAuth callback token in URL
  const params = new URLSearchParams(window.location.search);
  const token = params.get('token');
  const err = params.get('error');
  if (token) { userToken = token; localStorage.setItem('nml_user', token); window.history.replaceState({}, '', '/'); toast('Logged in with Discord! üéâ'); }
  if (err) { toast('Login failed: ' + err, true); window.history.replaceState({}, '', '/'); }

  // Parse user
  if (userToken) {
    try {
      currentUser = parseJWT(userToken);
      applyTheme(currentUser.active_theme, currentUser.custom_color1, currentUser.custom_color2);
    } catch(e) { userToken = null; localStorage.removeItem('nml_user'); }
  } else {
    // Load saved theme from localStorage
    const savedTheme = localStorage.getItem('nml_theme');
    if (savedTheme) applyTheme(savedTheme);
  }

  renderNavUser();
  loadProducts();
  loadAnnouncement();
  setupCursor();
  setupTicker();
  setupReveal();
});

function parseJWT(token) {
  const base64 = token.split('.')[1].replace(/-/g,'+').replace(/_/g,'/');
  return JSON.parse(atob(base64));
}

// ‚îÄ‚îÄ CURSOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function setupCursor() {
  const dot=document.getElementById('curDot'),ring=document.getElementById('curRing');
  let mx=0,my=0,rx=0,ry=0;
  document.addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY;dot.style.left=mx+'px';dot.style.top=my+'px'});
  (function anim(){rx+=(mx-rx)*.1;ry+=(my-ry)*.1;ring.style.left=rx+'px';ring.style.top=ry+'px';requestAnimationFrame(anim)})();
}

function setupTicker() {
  const ti=['Digital Products','Accounts','Software','Gaming','Fast Delivery','Trusted Seller','Themes Available','Coupons','Real Prices','Discord Support','Always Stocked'];
  const tt=[...ti,...ti];
  document.getElementById('tickerTrack').innerHTML=tt.map(i=>`<span class="ticker-item">${i} <span style="opacity:.3">‚óÜ</span></span>`).join('');
}

function setupReveal() {
  const ro=new IntersectionObserver(es=>es.forEach(e=>{if(e.isIntersecting){e.target.classList.add('vis');ro.unobserve(e.target)}}),{threshold:.1});
  document.querySelectorAll('.reveal').forEach(r=>ro.observe(r));
}

function smoothTo(sel){document.querySelector(sel)?.scrollIntoView({behavior:'smooth'})}
function toast(msg,err=false){const t=document.getElementById('toast');t.textContent=msg;t.className='toast'+(err?' error':'');void t.offsetWidth;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),3200)}
function openModal(id){document.getElementById(id).classList.add('open')}
function closeModal(id){document.getElementById(id).classList.remove('open')}
document.querySelectorAll('.modal-overlay').forEach(o=>{o.addEventListener('click',e=>{if(e.target===o)o.classList.remove('open')})});

// ‚îÄ‚îÄ THEME ENGINE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function applyTheme(theme, c1, c2) {
  document.body.className = theme ? `theme-${theme}` : 'theme-yellow';
  if (theme === 'custom' && c1) {
    document.documentElement.style.setProperty('--accent', c1);
    const [r,g,b] = hexToRgb(c1);
    document.documentElement.style.setProperty('--accent-rgb', `${r},${g},${b}`);
    if (c2) {
      // Apply gradient to key elements
      const style = document.getElementById('customGradientStyle') || document.createElement('style');
      style.id = 'customGradientStyle';
      style.textContent = `.logo,.hero-title .t2,.pc-price,.stat-n,.detail-price{background:linear-gradient(90deg,${c1},${c2});-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.ticker,.btn-primary,.nav-discord{background:linear-gradient(90deg,${c1},${c2});color:#000}`;
      document.head.appendChild(style);
    }
  } else {
    const el = document.getElementById('customGradientStyle');
    if (el) el.remove();
    document.documentElement.style.removeProperty('--accent');
    document.documentElement.style.removeProperty('--accent-rgb');
  }
  if (!currentUser) localStorage.setItem('nml_theme', theme);
}

function hexToRgb(hex) {
  const r = parseInt(hex.slice(1,3),16), g = parseInt(hex.slice(3,5),16), b = parseInt(hex.slice(5,7),16);
  return [r,g,b];
}

function updateGradientPreview() {
  const c1 = document.getElementById('customColor1').value;
  const c2 = document.getElementById('customColor2').value;
  document.getElementById('gradientPreview').style.background = `linear-gradient(90deg,${c1},${c2})`;
}

function applyCustomTheme() {
  if (!currentUser?.is_member) { toast('Membership required for custom themes', true); return; }
  const c1 = document.getElementById('customColor1').value;
  const c2 = document.getElementById('customColor2').value;
  saveTheme('custom', c1, c2);
}

async function saveTheme(theme, c1, c2) {
  applyTheme(theme, c1, c2);
  if (userToken) {
    try {
      const res = await fetch(`${API}/me/theme`, {
        method: 'POST', headers: { 'Authorization': 'Bearer ' + userToken, 'Content-Type': 'application/json' },
        body: JSON.stringify({ theme, custom_color1: c1||null, custom_color2: c2||null })
      });
      const data = await res.json();
      if (res.ok && data.token) { userToken = data.token; localStorage.setItem('nml_user', userToken); currentUser = parseJWT(userToken); }
      if (!res.ok) { toast(data.error, true); return; }
    } catch(e) {}
  }
  toast(`Theme applied: ${THEME_NAMES[theme] || 'Custom'} ‚ú®`);
  closeModal('themeOverlay');
}

function openThemePicker() {
  const owned = currentUser ? (currentUser.owned_themes || ['yellow']) : ['yellow'];
  const isMember = currentUser?.is_member || false;
  const active = currentUser?.active_theme || localStorage.getItem('nml_theme') || 'yellow';

  const grid = document.getElementById('themeGrid');
  grid.innerHTML = THEMES.map(t => {
    const isOwned = owned.includes(t) || t === 'yellow';
    const isActive = active === t;
    return `<div class="theme-swatch swatch-${t} ${isActive?'active':''} ${isOwned?'':'locked'}" 
      onclick="${isOwned ? `saveTheme('${t}')` : `toast('You don\\'t own the ${THEME_NAMES[t]} theme. Ask the owner for it!', true)`}"
      title="${THEME_NAMES[t]}${isOwned?'':' (locked)'}">
      ${!isOwned ? '' : isActive ? '‚úì' : ''}
    </div>`;
  }).join('');

  // Custom gradient section
  const customSection = document.getElementById('customThemeSection');
  const memberNote = document.getElementById('themeMemberNote');
  if (isMember) {
    customSection.classList.add('show');
    memberNote.style.display = 'none';
    updateGradientPreview();
  } else if (!userToken) {
    customSection.classList.remove('show');
    memberNote.style.display = 'block';
  } else {
    customSection.classList.remove('show');
    memberNote.style.display = 'none';
  }

  document.getElementById('themeSubtitle').textContent = currentUser ? `Logged in as ${currentUser.username}` : 'Login with Discord to save themes';
  openModal('themeOverlay');
}

// ‚îÄ‚îÄ NAV USER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderNavUser() {
  const area = document.getElementById('navUserArea');
  if (currentUser) {
    const avatarUrl = currentUser.avatar
      ? `https://cdn.discordapp.com/avatars/${currentUser.id}/${currentUser.avatar}.png?size=64`
      : `https://cdn.discordapp.com/embed/avatars/0.png`;
    area.innerHTML = `
      <div class="nav-user">
        <img class="nav-avatar" src="${avatarUrl}" alt="${currentUser.username}">
        <span class="nav-username">${currentUser.username}</span>
        <div class="user-dropdown">
          <button class="user-dropdown-item" onclick="openThemePicker()">üé® Themes</button>
          <button class="user-dropdown-item danger" onclick="userLogout()">Logout</button>
        </div>
      </div>`;
  } else {
    area.innerHTML = `<a href="/auth/discord" class="nav-btn" style="color:var(--accent3)">Login with Discord</a>
    <button class="nav-btn" onclick="openThemePicker()" style="font-size:16px" title="Themes">üé®</button>`;
  }
}

function userLogout() {
  userToken = null; currentUser = null;
  localStorage.removeItem('nml_user');
  applyTheme('yellow');
  renderNavUser();
  toast('Logged out');
}

// ‚îÄ‚îÄ ANNOUNCEMENT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadAnnouncement() {
  try {
    const res = await fetch(`${API}/announcements`);
    const a = await res.json();
    if (a?.message) {
      document.getElementById('announceText').textContent = a.message;
      const banner = document.getElementById('announceBanner');
      banner.className = a.color || 'yellow';
      banner.style.display = 'block';
      document.getElementById('mainNav').style.top = '40px';
    }
  } catch(e) {}
}

function dismissBanner() {
  document.getElementById('announceBanner').style.display = 'none';
  document.getElementById('mainNav').style.top = '0';
}

// ‚îÄ‚îÄ PRODUCTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadProducts(search = '') {
  try {
    const url = search ? `${API}/products?search=${encodeURIComponent(search)}` : `${API}/products`;
    const res = await fetch(url);
    allProducts = await res.json();
    document.getElementById('statProducts').textContent = allProducts.filter(p => !p.coming_soon).length;
    if (!search) buildFilters();
    renderProducts(allProducts);
  } catch(e) {
    document.getElementById('loadingGrid').innerHTML = `<div class="empty-state">‚ö† Could not connect to server</div>`;
  }
}

let searchDebounce;
function handleSearch(val) {
  clearTimeout(searchDebounce);
  searchDebounce = setTimeout(() => loadProducts(val.trim()), 300);
}

function buildFilters() {
  const cats = ['All', ...new Set(allProducts.map(p => p.category).filter(Boolean))];
  document.getElementById('filterBar').innerHTML = cats.map(c => `<button class="filter-btn${c==='All'?' active':''}" onclick="setFilter('${c}')">${c}</button>`).join('');
}

function setFilter(cat) {
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.toggle('active', b.textContent === cat));
  renderProducts(cat === 'All' ? allProducts : allProducts.filter(p => p.category === cat));
}

function priceHtml(price, orig) {
  if (orig && orig > price) return `<span class="orig">$${parseFloat(orig).toFixed(2)}</span>$${parseFloat(price).toFixed(2)}`;
  return `$${parseFloat(price).toFixed(2)}`;
}

function renderProducts(products) {
  document.getElementById('loadingGrid').style.display = 'none';
  const grid = document.getElementById('productsGrid');
  grid.style.display = 'grid';
  if (!products.length) { grid.innerHTML = `<div class="empty-state">No products found</div>`; return; }
  grid.innerHTML = products.map(p => `
    <div class="product-card${p.coming_soon?' coming-soon':''}" onclick="${p.coming_soon ? `openWaitlist(${JSON.stringify(p).replace(/"/g,'&quot;')})` : `openDetail('${p.id}')`}">
      <div class="pc-img">
        ${p.image ? `<img src="${p.image}" alt="${p.name}" loading="lazy">` : `<div class="pc-img-placeholder">NML</div>`}
        <div class="pc-overlay"></div>
        ${p.badge ? `<div class="pc-badge badge-${p.badge.toLowerCase()}">${p.badge}</div>` : ''}
        ${p.views ? `<div class="pc-views">üëÅ ${p.views}</div>` : ''}
        ${!p.coming_soon ? `<div class="pc-buy">View & Buy ‚Üí</div>` : ''}
      </div>
      <div class="pc-body">
        <div class="pc-cat">${p.category || 'Digital'}</div>
        <div class="pc-name">${p.name}</div>
        ${p.variants?.length ? `<div class="pc-variants">${p.variants.slice(0,3).map(v=>`<span class="pc-variant-tag">${v.name}</span>`).join('')}${p.variants.length>3?`<span class="pc-variant-tag">+${p.variants.length-3}</span>`:''}</div>` : p.description ? `<div class="pc-desc">${p.description.substring(0,80)}${p.description.length>80?'‚Ä¶':''}</div>` : ''}
        <div class="pc-foot">
          <div class="pc-price">${p.coming_soon ? 'TBA' : priceHtml(p.price, p.original_price)}</div>
          <div class="pc-stock">${p.coming_soon ? 'Coming Soon' : p.stock > 100 ? 'In Stock' : p.stock > 0 ? p.stock+' left' : 'Out of Stock'}</div>
        </div>
      </div>
    </div>`).join('');
}

// ‚îÄ‚îÄ PRODUCT DETAIL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function openDetail(id) {
  selectedVariant = null; appliedCoupon = null;
  document.getElementById('couponInput').value = '';
  document.getElementById('couponStatus').style.display = 'none';
  document.getElementById('finalPriceRow').style.display = 'none';
  document.getElementById('detailDiscordUser').value = currentUser ? currentUser.username : '';

  try {
    const res = await fetch(`${API}/products/${id}`);
    const p = await res.json();
    currentProduct = p;
    document.getElementById('detailImg').innerHTML = p.image ? `<img src="${p.image}" alt="${p.name}">` : `<div class="detail-img-placeholder">NML</div>`;
    document.getElementById('detailCat').textContent = p.category || 'Digital';
    document.getElementById('detailViews').textContent = `üëÅ ${(p.views||0)+1} views`;
    document.getElementById('detailName').textContent = p.name;
    document.getElementById('detailPrice').innerHTML = priceHtml(p.price, p.original_price);
    document.getElementById('detailDesc').textContent = p.description || '';
    const varSec = document.getElementById('variantsSection');
    if (p.variants?.length) {
      varSec.style.display = 'block';
      document.getElementById('variantsGrid').innerHTML = p.variants.map(v => `
        <div class="variant-row" id="vrow-${v.id}" onclick="selectVariant(${JSON.stringify(v).replace(/"/g,'&quot;')})">
          <div><div class="variant-name">${v.name}</div><span class="variant-stock">${v.stock>0?v.stock+' left':'Out of Stock'}</span></div>
          <div>${v.original_price?`<span class="variant-orig">$${parseFloat(v.original_price).toFixed(2)}</span>`:''}<span class="variant-price">$${parseFloat(v.price).toFixed(2)}</span></div>
        </div>`).join('');
    } else { varSec.style.display = 'none'; }
    openModal('detailOverlay');
    setTimeout(loadProducts, 1500);
  } catch(e) { toast('Failed to load product', true); }
}

function selectVariant(v) {
  selectedVariant = v;
  document.querySelectorAll('.variant-row').forEach(r => r.classList.remove('selected'));
  document.getElementById('vrow-'+v.id)?.classList.add('selected');
  document.getElementById('detailPrice').innerHTML = priceHtml(v.price, v.original_price);
  appliedCoupon = null;
  document.getElementById('couponInput').value = '';
  document.getElementById('couponStatus').style.display = 'none';
  document.getElementById('finalPriceRow').style.display = 'none';
}

async function applyCoupon() {
  const code = document.getElementById('couponInput').value.trim();
  const statusEl = document.getElementById('couponStatus');
  const finalRow = document.getElementById('finalPriceRow');
  if (!code) return;
  const basePrice = selectedVariant ? selectedVariant.price : currentProduct?.price || 0;
  try {
    const res = await fetch(`${API}/coupons/validate`, { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({code, price: basePrice}) });
    const data = await res.json();
    if (res.ok) {
      appliedCoupon = data;
      statusEl.textContent = `‚úì ${data.discount_percent}% off applied!`; statusEl.className = 'coupon-status ok'; statusEl.style.display = 'block';
      document.getElementById('finalPriceVal').textContent = `$${parseFloat(data.final_price).toFixed(2)}`;
      finalRow.style.display = 'flex';
    } else {
      appliedCoupon = null;
      statusEl.textContent = data.error; statusEl.className = 'coupon-status err'; statusEl.style.display = 'block';
      finalRow.style.display = 'none';
    }
  } catch(e) { statusEl.textContent = 'Error checking coupon'; statusEl.className = 'coupon-status err'; statusEl.style.display = 'block'; }
}

async function submitDetailInquiry() {
  if (!currentProduct) return;
  if (currentProduct.variants?.length && !selectedVariant) { toast('Please select a variant first', true); return; }
  const username = document.getElementById('detailDiscordUser').value.trim() || (currentUser?.username) || 'Not provided';
  const basePrice = selectedVariant ? selectedVariant.price : currentProduct.price;
  const finalPrice = appliedCoupon ? appliedCoupon.final_price : basePrice;
  try {
    await fetch(`${API}/inquiries`, { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({
      product_id: currentProduct.id, product_name: currentProduct.name, product_price: basePrice,
      variant_name: selectedVariant?.name || null, discord_username: username,
      discord_id: currentUser?.id || null, coupon_code: appliedCoupon?.code || null,
      discount_amount: appliedCoupon ? appliedCoupon.discount_amount : 0, final_price: finalPrice
    })});
  } catch(e) {}
  window.open('https://discord.gg/yRDud7tW', '_blank');
  closeModal('detailOverlay');
  toast('Opening Discord ‚Äî complete your purchase there!');
}

// ‚îÄ‚îÄ WAITLIST ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openWaitlist(product) {
  waitlistProduct = product;
  document.getElementById('waitlistProductName').textContent = product.name;
  document.getElementById('waitlistDiscord').value = currentUser ? currentUser.username : '';
  openModal('waitlistOverlay');
}

async function submitWaitlist() {
  const username = document.getElementById('waitlistDiscord').value.trim();
  if (!username) { toast('Enter your Discord username', true); return; }
  try {
    await fetch(`${API}/waitlist`, { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({ product_id: waitlistProduct.id, product_name: waitlistProduct.name, discord_username: username }) });
    toast("You're on the waitlist! We'll DM you when it drops üî•");
    closeModal('waitlistOverlay');
  } catch(e) { toast('Error', true); }
}

// ‚îÄ‚îÄ ADMIN AUTH ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openLogin() { openModal('loginOverlay'); setTimeout(() => document.getElementById('loginPassword').focus(), 100); }

async function doLogin() {
  const pw = document.getElementById('loginPassword').value;
  const errEl = document.getElementById('loginError'); const btn = document.getElementById('loginBtn');
  errEl.style.display = 'none'; btn.textContent = 'Checking...'; btn.disabled = true;
  try {
    const res = await fetch(`${API}/admin/login`, { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({password: pw}) });
    const data = await res.json();
    if (res.ok) { adminToken = data.token; sessionStorage.setItem('nml_admin', adminToken); closeModal('loginOverlay'); document.getElementById('loginPassword').value = ''; openAdminPanel(); toast('Welcome back üî´'); }
    else { errEl.style.display = 'block'; }
  } catch(e) { errEl.textContent = 'Cannot reach server.'; errEl.style.display = 'block'; }
  btn.textContent = 'Enter'; btn.disabled = false;
}

function adminLogout() { adminToken = null; sessionStorage.removeItem('nml_admin'); closeModal('adminOverlay'); toast('Logged out'); }

async function openAdminPanel() {
  openModal('adminOverlay');
  const res = await fetch(`${API}/products`);
  renderAdminList(await res.json());
}

// ‚îÄ‚îÄ ADMIN TABS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function switchTab(name) {
  const tabs = ['products','orders','coupons','waitlist','stats','announce'];
  document.querySelectorAll('.admin-tab').forEach((t,i) => t.classList.toggle('active', tabs[i] === name));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  document.getElementById('tab-'+name).classList.add('active');
  if (name === 'orders') loadInquiries();
  if (name === 'coupons') loadCoupons();
  if (name === 'waitlist') loadWaitlist();
  if (name === 'stats') loadStats();
}

// ‚îÄ‚îÄ ADMIN PRODUCTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderAdminList(products) {
  const list = document.getElementById('adminProdList');
  if (!products.length) { list.innerHTML = `<div style="font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--muted);padding:12px">No products</div>`; return; }
  list.innerHTML = products.map(p => `
    <div class="prod-item" onclick="loadEditForm(${JSON.stringify(p).replace(/"/g,'&quot;')})">
      ${p.image ? `<img class="prod-item-img" src="${p.image}" alt="${p.name}">` : `<div class="prod-item-img" style="display:flex;align-items:center;justify-content:center;font-size:16px">üì¶</div>`}
      <div><div class="prod-item-name">${p.name}</div><div class="prod-item-cat">${p.category||'Digital'}${p.variants?.length?' ¬∑ '+p.variants.length+' variants':''}</div></div>
      <div class="prod-item-price">${p.coming_soon?'TBA':'$'+parseFloat(p.price).toFixed(2)}</div>
    </div>`).join('');
}

function addVariantRow(v={}) {
  const idx = variantRows.length; variantRows.push(v);
  const row = document.createElement('div'); row.className = 'variant-edit-row'; row.id = 'vr-'+idx;
  row.innerHTML = `
    <input type="text" placeholder="e.g. 1 Month" value="${v.name||''}" oninput="variantRows[${idx}].name=this.value">
    <input type="number" placeholder="Price" step="0.01" value="${v.price||''}" oninput="variantRows[${idx}].price=this.value">
    <input type="number" placeholder="Orig $" step="0.01" value="${v.original_price||''}" oninput="variantRows[${idx}].original_price=this.value">
    <input type="number" placeholder="Stock" value="${v.stock||999}" oninput="variantRows[${idx}].stock=this.value">
    <button class="btn-rm-variant" onclick="document.getElementById('vr-${idx}').remove();variantRows[${idx}]=null">‚úï</button>`;
  document.getElementById('variantsEditor').appendChild(row);
}

function resetForm() {
  ['editId','fName','fPrice','fOriginalPrice','fDesc','fStock'].forEach(id => document.getElementById(id).value = '');
  document.getElementById('fCategory').value = 'Accounts';
  document.getElementById('fBadge').value = '';
  document.getElementById('fFeatured').checked = false;
  document.getElementById('fComingSoon').checked = false;
  document.getElementById('fImage').value = '';
  document.getElementById('imgPreview').style.display = 'none';
  document.getElementById('formTitle').textContent = 'Create New Product';
  document.getElementById('saveBtn').textContent = 'Save Product';
  document.getElementById('deleteBtn').style.display = 'none';
  document.getElementById('variantsEditor').innerHTML = ''; variantRows = [];
}

function loadEditForm(p) {
  document.getElementById('editId').value = p.id;
  document.getElementById('fName').value = p.name;
  document.getElementById('fPrice').value = p.price;
  document.getElementById('fOriginalPrice').value = p.original_price || '';
  document.getElementById('fDesc').value = p.description || '';
  document.getElementById('fCategory').value = p.category || 'Accounts';
  document.getElementById('fBadge').value = p.badge || '';
  document.getElementById('fStock').value = p.stock || 999;
  document.getElementById('fFeatured').checked = p.featured || false;
  document.getElementById('fComingSoon').checked = p.coming_soon || false;
  document.getElementById('formTitle').textContent = 'Editing: ' + p.name;
  document.getElementById('saveBtn').textContent = 'Update Product';
  document.getElementById('deleteBtn').style.display = 'block';
  if (p.image) { const prev = document.getElementById('imgPreview'); prev.src = p.image; prev.style.display = 'block'; }
  else document.getElementById('imgPreview').style.display = 'none';
  document.getElementById('variantsEditor').innerHTML = ''; variantRows = [];
  if (p.variants?.length) p.variants.forEach(v => addVariantRow(v));
  document.getElementById('adminOverlay').scrollTop = 0;
}

function previewImage(e) {
  const file = e.target.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = ev => { const prev = document.getElementById('imgPreview'); prev.src = ev.target.result; prev.style.display = 'block'; };
  reader.readAsDataURL(file);
}

async function saveProduct() {
  const id = document.getElementById('editId').value;
  const name = document.getElementById('fName').value.trim();
  const price = document.getElementById('fPrice').value;
  if (!name || !price) { toast('Name and price required', true); return; }
  const btn = document.getElementById('saveBtn'); btn.textContent = 'Saving...'; btn.disabled = true;
  const fd = new FormData();
  fd.append('name', name); fd.append('price', price);
  fd.append('original_price', document.getElementById('fOriginalPrice').value || '');
  fd.append('description', document.getElementById('fDesc').value);
  fd.append('category', document.getElementById('fCategory').value);
  fd.append('badge', document.getElementById('fBadge').value);
  fd.append('stock', document.getElementById('fStock').value || 999);
  fd.append('featured', document.getElementById('fFeatured').checked);
  fd.append('coming_soon', document.getElementById('fComingSoon').checked);
  const validVariants = variantRows.filter(v => v && v.name && v.price);
  fd.append('variants', JSON.stringify(validVariants));
  const imgFile = document.getElementById('fImage').files[0];
  if (imgFile) fd.append('image', imgFile);
  try {
    const url = id ? `${API}/products/${id}` : `${API}/products`;
    const res = await fetch(url, { method: id ? 'PUT' : 'POST', headers: {'Authorization':'Bearer '+adminToken}, body: fd });
    if (res.ok) { toast(id ? 'Updated!' : 'Created! üî•'); resetForm(); loadProducts(); const r = await fetch(`${API}/products`); renderAdminList(await r.json()); }
    else { const err = await res.json(); toast(err.error || 'Error', true); }
  } catch(e) { toast('Server error', true); }
  btn.textContent = id ? 'Update Product' : 'Save Product'; btn.disabled = false;
}

async function deleteProduct() {
  const id = document.getElementById('editId').value; if (!id) return;
  if (!confirm('Delete this product?')) return;
  try {
    const res = await fetch(`${API}/products/${id}`, { method: 'DELETE', headers: {'Authorization':'Bearer '+adminToken} });
    if (res.ok) { toast('Deleted'); resetForm(); loadProducts(); const r = await fetch(`${API}/products`); renderAdminList(await r.json()); }
    else toast('Failed', true);
  } catch(e) { toast('Error', true); }
}

// ‚îÄ‚îÄ ORDERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadInquiries() {
  const c = document.getElementById('inquiryContainer'); c.innerHTML = '<div class="inq-empty">Loading...</div>';
  try {
    const res = await fetch(`${API}/inquiries`, { headers: {'Authorization':'Bearer '+adminToken} });
    const data = await res.json();
    if (!data.length) { c.innerHTML = '<div class="inq-empty">No orders yet</div>'; return; }
    c.innerHTML = `<table class="inq-table"><thead><tr><th>Product</th><th>Variant</th><th>Price</th><th>Coupon</th><th>Discord</th><th>Date</th><th>Status</th></tr></thead><tbody>
    ${data.map(inq=>`<tr>
      <td><div class="inq-product">${inq.product_name}</div></td>
      <td>${inq.variant_name||'‚Äî'}</td>
      <td><div class="inq-price">$${parseFloat(inq.final_price||0).toFixed(2)}</div></td>
      <td>${inq.coupon_code?`<span class="coupon-code" style="font-size:10px">${inq.coupon_code}</span>`:'‚Äî'}</td>
      <td><div class="inq-user">${inq.discord_username||'‚Äî'}</div></td>
      <td><div class="inq-date">${new Date(inq.created_at).toLocaleDateString('en-US',{month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'})}</div></td>
      <td><button class="status-badge status-${inq.status||'pending'}" onclick="cycleStatus('${inq.id}','${inq.status||'pending'}')">${inq.status||'pending'}</button></td>
    </tr>`).join('')}</tbody></table>`;
  } catch(e) { c.innerHTML = '<div class="inq-empty">Error</div>'; }
}

async function cycleStatus(id, current) {
  const next = {pending:'done',done:'cancelled',cancelled:'pending'}[current]||'pending';
  try { await fetch(`${API}/inquiries/${id}`, { method: 'PATCH', headers: {'Authorization':'Bearer '+adminToken,'Content-Type':'application/json'}, body: JSON.stringify({status:next}) }); loadInquiries(); }
  catch(e) { toast('Failed', true); }
}

// ‚îÄ‚îÄ COUPONS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadCoupons() {
  const c = document.getElementById('couponList'); c.innerHTML = '<div class="inq-empty">Loading...</div>';
  try {
    const res = await fetch(`${API}/coupons`, { headers: {'Authorization':'Bearer '+adminToken} });
    const data = await res.json();
    if (!data.length) { c.innerHTML = '<div class="inq-empty">No coupons yet</div>'; return; }
    c.innerHTML = `<table class="coupon-table"><thead><tr><th>Code</th><th>Discount</th><th>Uses</th><th>Max</th><th>Expires</th><th>Active</th><th></th></tr></thead><tbody>
    ${data.map(cp=>`<tr>
      <td><span class="coupon-code">${cp.code}</span></td>
      <td>${cp.discount_percent}%</td><td>${cp.uses}</td><td>${cp.max_uses||'‚àû'}</td>
      <td style="font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--muted)">${cp.expires_at?new Date(cp.expires_at).toLocaleDateString():'Never'}</td>
      <td>${cp.active&&(!cp.expires_at||new Date(cp.expires_at)>new Date())?'‚úÖ':'‚ùå'}</td>
      <td><button class="btn-coupon-del" onclick="deleteCoupon('${cp.id}')">üóë</button></td>
    </tr>`).join('')}</tbody></table>`;
  } catch(e) { c.innerHTML = '<div class="inq-empty">Error</div>'; }
}

async function createCoupon() {
  const code = document.getElementById('cCode').value.trim();
  const percent = document.getElementById('cPercent').value;
  const maxUses = document.getElementById('cMaxUses').value || 0;
  const expiry = document.getElementById('cExpiry').value || null;
  if (!code || !percent) { toast('Code and percent required', true); return; }
  try {
    const res = await fetch(`${API}/coupons`, { method: 'POST', headers: {'Authorization':'Bearer '+adminToken,'Content-Type':'application/json'}, body: JSON.stringify({code, discount_percent: parseFloat(percent), max_uses: parseInt(maxUses), expires_at: expiry}) });
    if (res.ok) { toast(`Coupon ${code} created!`); document.getElementById('cCode').value=''; document.getElementById('cPercent').value=''; document.getElementById('cExpiry').value=''; loadCoupons(); }
    else { const err = await res.json(); toast(err.error||'Error', true); }
  } catch(e) { toast('Error', true); }
}

async function deleteCoupon(id) {
  if (!confirm('Delete this coupon?')) return;
  try { await fetch(`${API}/coupons/${id}`, { method: 'DELETE', headers: {'Authorization':'Bearer '+adminToken} }); loadCoupons(); }
  catch(e) { toast('Error', true); }
}

// ‚îÄ‚îÄ WAITLIST ADMIN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadWaitlist() {
  const c = document.getElementById('waitlistContainer'); c.innerHTML = '<div class="inq-empty">Loading...</div>';
  try {
    const res = await fetch(`${API}/waitlist`, { headers: {'Authorization':'Bearer '+adminToken} });
    const data = await res.json();
    if (!data.length) { c.innerHTML = '<div class="inq-empty">No signups yet</div>'; return; }
    c.innerHTML = `<table class="waitlist-table"><thead><tr><th>Product</th><th>Discord</th><th>Date</th></tr></thead><tbody>
    ${data.map(w=>`<tr><td>${w.product_name}</td><td style="font-family:'Share Tech Mono',monospace;font-size:11px;color:#00b8d4">${w.discord_username}</td><td style="font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--muted)">${new Date(w.created_at).toLocaleDateString()}</td></tr>`).join('')}
    </tbody></table>`;
  } catch(e) { c.innerHTML = '<div class="inq-empty">Error</div>'; }
}

// ‚îÄ‚îÄ STATS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadStats() {
  const g = document.getElementById('statsGrid'); g.innerHTML = '<div class="inq-empty" style="grid-column:1/-1">Loading...</div>';
  try {
    const res = await fetch(`${API}/stats`, { headers: {'Authorization':'Bearer '+adminToken} });
    const s = await res.json();
    g.innerHTML = `
      <div class="stat-card"><div class="stat-card-n">$${s.total_revenue}</div><div class="stat-card-l">Total Revenue</div></div>
      <div class="stat-card"><div class="stat-card-n">${s.total_orders}</div><div class="stat-card-l">Total Orders</div></div>
      <div class="stat-card"><div class="stat-card-n">${s.orders_this_week}</div><div class="stat-card-l">Orders This Week</div></div>
      <div class="stat-card" style="grid-column:1/-1"><div class="stat-card-l" style="margin-bottom:6px">Top Product</div><div style="font-size:18px;font-weight:700;color:var(--text)">${s.top_product}</div></div>`;
  } catch(e) { g.innerHTML = '<div class="inq-empty" style="grid-column:1/-1">Error loading stats</div>'; }
}

// ‚îÄ‚îÄ ANNOUNCE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function postAnnouncement() {
  const message = document.getElementById('aMessage').value.trim();
  const color = document.getElementById('aColor').value;
  if (!message) { toast('Enter a message', true); return; }
  try {
    await fetch(`${API}/announcements`, { method: 'POST', headers: {'Authorization':'Bearer '+adminToken,'Content-Type':'application/json'}, body: JSON.stringify({message,color}) });
    toast('Banner posted!'); loadAnnouncement();
  } catch(e) { toast('Error', true); }
}

async function clearAnnouncement() {
  try { await fetch(`${API}/announcements`, { method: 'DELETE', headers: {'Authorization':'Bearer '+adminToken} }); dismissBanner(); toast('Banner cleared'); }
  catch(e) { toast('Error', true); }
}
</script>
</body>
</html>
